---
/**
 * Pagination - Blog listing pagination
 */
interface Props {
  currentPage: number;
  totalPages: number;
  basePath: string;
}

const { currentPage, totalPages, basePath } = Astro.props;

// Don't render if only one page
if (totalPages <= 1) return null;

// Generate page numbers to show
function getPageNumbers(): (number | 'ellipsis')[] {
  const pages: (number | 'ellipsis')[] = [];
  const showPages = 5;

  if (totalPages <= showPages) {
    for (let i = 1; i <= totalPages; i++) pages.push(i);
  } else {
    pages.push(1);

    if (currentPage > 3) pages.push('ellipsis');

    const start = Math.max(2, currentPage - 1);
    const end = Math.min(totalPages - 1, currentPage + 1);

    for (let i = start; i <= end; i++) pages.push(i);

    if (currentPage < totalPages - 2) pages.push('ellipsis');

    pages.push(totalPages);
  }

  return pages;
}

const pageNumbers = getPageNumbers();
const prevPage = currentPage > 1 ? currentPage - 1 : null;
const nextPage = currentPage < totalPages ? currentPage + 1 : null;

function getPageUrl(page: number): string {
  return page === 1 ? basePath : `${basePath}?page=${page}`;
}
---

<nav class="flex items-center justify-center gap-2 mt-12" aria-label="Paginacion">
  {/* Previous */}
  {prevPage ? (
    <a
      href={getPageUrl(prevPage)}
      class="flex items-center gap-1 px-3 py-2 text-sm font-medium text-gris-600 dark:text-crema-300 bg-gris-100 dark:bg-verde-900/30 rounded-lg hover:bg-gris-200 dark:hover:bg-verde-800/50 transition-colors"
      aria-label="Pagina anterior"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
      <span class="hidden sm:inline">Anterior</span>
    </a>
  ) : (
    <span class="flex items-center gap-1 px-3 py-2 text-sm font-medium text-gris-400 dark:text-gris-600 cursor-not-allowed">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
      <span class="hidden sm:inline">Anterior</span>
    </span>
  )}

  {/* Page numbers */}
  <div class="flex items-center gap-1">
    {pageNumbers.map((page) => (
      page === 'ellipsis' ? (
        <span class="px-2 py-1 text-gris-400 dark:text-gris-600">...</span>
      ) : (
        <a
          href={getPageUrl(page)}
          class:list={[
            'w-10 h-10 flex items-center justify-center rounded-lg text-sm font-medium transition-colors',
            page === currentPage
              ? 'bg-verde-600 text-white'
              : 'text-gris-600 dark:text-crema-300 hover:bg-gris-100 dark:hover:bg-verde-900/30'
          ]}
          aria-current={page === currentPage ? 'page' : undefined}
        >
          {page}
        </a>
      )
    ))}
  </div>

  {/* Next */}
  {nextPage ? (
    <a
      href={getPageUrl(nextPage)}
      class="flex items-center gap-1 px-3 py-2 text-sm font-medium text-gris-600 dark:text-crema-300 bg-gris-100 dark:bg-verde-900/30 rounded-lg hover:bg-gris-200 dark:hover:bg-verde-800/50 transition-colors"
      aria-label="Pagina siguiente"
    >
      <span class="hidden sm:inline">Siguiente</span>
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </a>
  ) : (
    <span class="flex items-center gap-1 px-3 py-2 text-sm font-medium text-gris-400 dark:text-gris-600 cursor-not-allowed">
      <span class="hidden sm:inline">Siguiente</span>
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </span>
  )}
</nav>
